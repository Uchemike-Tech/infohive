<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>InfoHive</title>
    <link rel="icon" type="image/png" href="assets/images/Logo.png">
    <link rel="stylesheet" href="assets/css/style.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@100;200;300;400;500;600;700&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" />
</head>
<body>
    <!-- HERO SECTION -->
    <section class="header">
        <nav>
            <a href="index.html"><img src="assets/images/Logo.png" alt="InfoHive Logo" /></a>
            <div class="nav-links" id="navLinks">
                <i class="fa fa-times" onclick="hideMenu()"></i>
                <ul>
                    <li><a href="index.html">Home</a></li>
                    <li><a href="announcements.html">Announcements</a></li>
                    <li><a href="events.html">Events</a></li>
                    <li><a href="timetable.html">Timetable</a></li>
                    <li><a href="admin-login.html" class="hero-btn">Admin</a></li>
                </ul>
            </div>
            <i class="fa fa-bars" onclick="showMenu()"></i>
        </nav>

        <div class="text-box">
            <h1>Welcome to InfoHive</h1>
            <p>Your digital hub for departmental updates, events, and resources.</p>
            <a href="announcements.html" class="hero-btn">See Latest Updates</a>
        </div>
    </section>

    <!-- Announcements Section -->
    <section class="section">
        <div class="announcements-header">
            <h1>Latest Announcements</h1>
            <a href="announcements.html" class="view-all">View All Announcements</a>
        </div>
        <div class="row" id="announcements-container">
            <!-- Sample announcements for fallback -->
            <div class="col">
                <h3>Course Registration Extended</h3>
                <p>The deadline for course registration has been extended to Friday, September 15th. Please ensure you complete your registration before the new deadline.</p>
            </div>
            <div class="col">
                <h3>Library Hours Update</h3>
                <p>The library will now be open 24/7 during exam periods. Additional study spaces have been made available on the 3rd floor.</p>
            </div>
            <div class="col">
                <h3>Department Meeting</h3>
                <p>All students are invited to attend the department meeting on September 20th at 2:00 PM in the main auditorium. Important updates will be shared.</p>
            </div>
        </div>
    </section>

    <!-- Event Calendar Section -->
    <section class="section">
        <div class="announcements-header">
            <h1>Event Calendar</h1>
            <a href="events.html" class="view-all">View All Events</a>
        </div>
        <div class="calendar-container">
            <div class="calendar-header">
                <button class="nav-btn" id="prev-month">&lt;</button>
                <h2 id="current-month-year"></h2>
                <button class="nav-btn" id="next-month">&gt;</button>
            </div>
            <div class="calendar">
                <div class="calendar-days">
                    <div class="day-header">Sun</div>
                    <div class="day-header">Mon</div>
                    <div class="day-header">Tue</div>
                    <div class="day-header">Wed</div>
                    <div class="day-header">Thu</div>
                    <div class="day-header">Fri</div>
                    <div class="day-header">Sat</div>
                </div>
                <div class="calendar-dates" id="calendar-dates">
                    <!-- Calendar dates will be generated here -->
                </div>
            </div>
        </div>
        <div class="events-list" id="events-list">
            <!-- Selected day's events will be displayed here -->
        </div>
    </section>

    <!-- Timetable Section -->
    <section class="section timetable">
        <h2>300L Rain Semester Timetable</h2>
        <table>
            <!-- Timetable content remains the same -->
        </table>
    </section>

    <!-- Footer -->
    <section class="footer">
        <h4>About InfoHive</h4>
        <p>Your one-stop digital board for all departmental information.</p>
        <div class="icons">
            <i class="fab fa-facebook"></i>
            <i class="fab fa-twitter"></i>
            <i class="fab fa-instagram"></i>
            <i class="fab fa-linkedin"></i>
        </div>
        <p>Made with by InfoHive Team</p>
    </section>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            fetch('/api/announcements')
                .then(response => response.json())
                .then(data => {
                    const container = document.getElementById('announcements-container');
                    data.slice(0, 3).forEach(announcement => {
                        const col = document.createElement('div');
                        col.classList.add('col');
                        col.innerHTML = `
                            <h3>${announcement.title}</h3>
                            <p>${announcement.content}</p>
                        `;
                        container.appendChild(col);
                    });
                });

            // Calendar functionality
            let currentDate = new Date();
            let eventsData = [];

            // Fetch events for calendar
            fetch('/api/events')
                .then(response => response.json())
                .then(data => {
                    eventsData = data;
                    generateCalendar(currentDate.getFullYear(), currentDate.getMonth());
                });

            function generateCalendar(year, month) {
                const firstDay = new Date(year, month, 1);
                const lastDay = new Date(year, month + 1, 0);
                const startDate = new Date(firstDay);
                const endDate = new Date(lastDay);
                
                // Adjust to show full weeks
                startDate.setDate(startDate.getDate() - startDate.getDay());
                endDate.setDate(endDate.getDate() + (6 - endDate.getDay()));

                const monthNames = ['January', 'February', 'March', 'April', 'May', 'June',
                    'July', 'August', 'September', 'October', 'November', 'December'];
                
                document.getElementById('current-month-year').textContent = `${monthNames[month]} ${year}`;
                
                const calendarDates = document.getElementById('calendar-dates');
                calendarDates.innerHTML = '';

                let currentDateIter = new Date(startDate);
                while (currentDateIter <= endDate) {
                    const dateDiv = document.createElement('div');
                    dateDiv.classList.add('calendar-date');
                    
                    const isCurrentMonth = currentDateIter.getMonth() === month;
                    const isToday = currentDateIter.toDateString() === new Date().toDateString();
                    
                    if (!isCurrentMonth) {
                        dateDiv.classList.add('other-month');
                    }
                    if (isToday) {
                        dateDiv.classList.add('today');
                    }

                    // Check for events on this date
                    const dateStr = currentDateIter.toISOString().split('T')[0];
                    const dayEvents = eventsData.filter(event => event.date === dateStr);
                    
                    if (dayEvents.length > 0) {
                        dateDiv.classList.add('has-events');
                    }

                    dateDiv.innerHTML = `
                        <span class="date-number">${currentDateIter.getDate()}</span>
                        ${dayEvents.length > 0 ? `<div class="event-indicator">${dayEvents.length}</div>` : ''}
                    `;
                    
                    dateDiv.addEventListener('click', () => showEventsForDate(dateStr, dayEvents));
                    calendarDates.appendChild(dateDiv);
                    
                    currentDateIter.setDate(currentDateIter.getDate() + 1);
                }
            }

            function showEventsForDate(date, events) {
                const eventsList = document.getElementById('events-list');
                
                if (events.length === 0) {
                    eventsList.innerHTML = `<p class="no-events">No events scheduled for ${new Date(date).toLocaleDateString()}</p>`;
                    return;
                }

                eventsList.innerHTML = `
                    <h3>Events for ${new Date(date).toLocaleDateString()}</h3>
                    ${events.map(event => `
                        <div class="event-card">
                            <h4>${event.title}</h4>
                            <p>${event.description}</p>
                            ${event.image ? `<img src="${event.image}" alt="${event.title}" class="event-image">` : ''}
                        </div>
                    `).join('')}
                `;
            }

            // Navigation buttons
            document.getElementById('prev-month').addEventListener('click', () => {
                currentDate.setMonth(currentDate.getMonth() - 1);
                generateCalendar(currentDate.getFullYear(), currentDate.getMonth());
            });

            document.getElementById('next-month').addEventListener('click', () => {
                currentDate.setMonth(currentDate.getMonth() + 1);
                generateCalendar(currentDate.getFullYear(), currentDate.getMonth());
            });
        });

        var navLinks = document.getElementById("navLinks");
        function showMenu() {
            navLinks.style.right = "0";
        }
        function hideMenu() {
            navLinks.style.right = "-200px";
        }
    </script>
</body>
</html>
